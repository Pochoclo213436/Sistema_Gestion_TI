services:

  # ==========================
  # API GATEWAY
  # ==========================
  - type: web
    name: api-gateway
    env: docker
    plan: free
    region: oregon
    dockerfilePath: ./services/api_gateway/Dockerfile
    dockerContext: ./services/api_gateway
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: ti-management-db
          property: connectionString
      - key: SECRET_KEY
        value: "YOUR_SECRET_KEY"
      - key: ENVIRONMENT
        value: production
      - key: DEBUG
        value: "false"
      - key: EQUIPOS_SERVICE_URL
        value: https://equipos-service-oy17.onrender.com
      - key: PROVEEDORES_SERVICE_URL
        value: https://proveedores-service-cgvs.onrender.com
      - key: MANTENIMIENTO_SERVICE_URL
        value: https://mantenimiento-service.onrender.com
      - key: REPORTES_SERVICE_URL
        value: https://reportes-service-e03k.onrender.com
      - key: AGENT_SERVICE_URL
        value: https://agent-service-odqo.onrender.com

  # ==========================
  # EQUIPOS SERVICE
  # ==========================
  - type: web
    name: equipos-service
    env: docker
    plan: free
    region: oregon
    dockerfilePath: ./services/equipos_service/Dockerfile
    dockerContext: ./services/equipos_service
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: ti-management-db
          property: connectionString
      - key: ENVIRONMENT
        value: production
      - key: DEBUG
        value: "false"

  # ==========================
  # PROVEEDORES SERVICE
  # ==========================
  - type: web
    name: proveedores-service
    env: docker
    plan: free
    region: oregon
    dockerfilePath: ./services/proveedores_service/Dockerfile
    dockerContext: ./services/proveedores_service
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: ti-management-db
          property: connectionString
      - key: ENVIRONMENT
        value: production
      - key: DEBUG
        value: "false"

  # ==========================
  # MANTENIMIENTO SERVICE
  # ==========================
  - type: web
    name: mantenimiento-service
    env: docker
    plan: free
    region: oregon
    dockerfilePath: ./services/mantenimiento_service/Dockerfile
    dockerContext: ./services/mantenimiento_service
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: ti-management-db
          property: connectionString
      - key: ENVIRONMENT
        value: production
      - key: DEBUG
        value: "false"

  # ==========================
  # REPORTES SERVICE
  # ==========================
  - type: web
    name: reportes-service
    env: docker
    plan: free
    region: oregon
    dockerfilePath: ./services/reportes_service/Dockerfile
    dockerContext: ./services/reportes_service
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: ti-management-db
          property: connectionString
      - key: REPORTS_PATH
        value: /data
      - key: ENVIRONMENT
        value: production
      - key: DEBUG
        value: "false"

  # ==========================
  # AGENT SERVICE
  # ==========================
  - type: web
    name: agent-service
    env: docker
    plan: free
    region: oregon
    dockerfilePath: ./services/agent_service/Dockerfile
    dockerContext: ./services/agent_service
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: ti-management-db
          property: connectionString
      - key: AGENT_RUN_INTERVAL_HOURS
        value: "24"
      - key: AGENT_MAINTENANCE_CHECK_DAYS
        value: "7"
      - key: ENVIRONMENT
        value: production
      - key: DEBUG
        value: "false"

  # ==========================
  # FRONTEND
  # ==========================
  - type: web
    name: ti-frontend
    env: docker
    plan: free
    region: oregon
    dockerfilePath: ./frontend/Dockerfile
    dockerContext: ./frontend
    envVars:
      - key: PUBLIC_GATEWAY_URL
        value: https://api-gateway-018c.onrender.com
